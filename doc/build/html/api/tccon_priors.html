<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tccon_priors module &mdash; ginput 1.1.6 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="mlo_smo_prep module" href="mlo_smo_prep.html" />
    <link rel="prev" title="Satellite priors interface" href="../code_design/sat_interface.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> ginput
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Using ginput:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ginput_usage/command_line_int.html">Ginput command line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ginput_usage/downloading_met.html">Downloading met files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ginput_usage/making_mod_files.html">Making model files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ginput_usage/making_vmr_files.html">Making VMR files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ginput_usage/making_map_files.html">Making .map and .map.nc files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ginput_usage/updating_noaa.html">Updating NOAA input data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ginput code overview:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../code_design/sat_interface.html">Satellite priors interface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ginput API documentation:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">tccon_priors module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.CH4TropicsRecord"><code class="docutils literal notranslate"><span class="pre">CH4TropicsRecord</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.CH4TropicsRecord.add_strat_prior"><code class="docutils literal notranslate"><span class="pre">CH4TropicsRecord.add_strat_prior()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.CH4TropicsRecord.get_frac_remaining_by_age"><code class="docutils literal notranslate"><span class="pre">CH4TropicsRecord.get_frac_remaining_by_age()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.CH4TropicsRecord.lat_bias_correction"><code class="docutils literal notranslate"><span class="pre">CH4TropicsRecord.lat_bias_correction()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.CO2TropicsRecord"><code class="docutils literal notranslate"><span class="pre">CO2TropicsRecord</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.CO2TropicsRecord.lat_bias_correction"><code class="docutils literal notranslate"><span class="pre">CO2TropicsRecord.lat_bias_correction()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.GasRecordDateError"><code class="docutils literal notranslate"><span class="pre">GasRecordDateError</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.GasRecordError"><code class="docutils literal notranslate"><span class="pre">GasRecordError</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.GasRecordExtrapolationError"><code class="docutils literal notranslate"><span class="pre">GasRecordExtrapolationError</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.GasRecordInconsistentDimsError"><code class="docutils literal notranslate"><span class="pre">GasRecordInconsistentDimsError</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.GasRecordInputMissingError"><code class="docutils literal notranslate"><span class="pre">GasRecordInputMissingError</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.GasRecordInputVerificationError"><code class="docutils literal notranslate"><span class="pre">GasRecordInputVerificationError</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.HFTropicsRecord"><code class="docutils literal notranslate"><span class="pre">HFTropicsRecord</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.HFTropicsRecord.add_extra_column"><code class="docutils literal notranslate"><span class="pre">HFTropicsRecord.add_extra_column()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.HFTropicsRecord.get_mlo_smo_mean"><code class="docutils literal notranslate"><span class="pre">HFTropicsRecord.get_mlo_smo_mean()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.HFTropicsRecord.list_strat_dependent_files"><code class="docutils literal notranslate"><span class="pre">HFTropicsRecord.list_strat_dependent_files()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord"><code class="docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.add_extra_column"><code class="docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord.add_extra_column()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.add_strat_prior"><code class="docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord.add_strat_prior()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.add_trop_prior"><code class="docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord.add_trop_prior()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.avg_gas_in_date_range"><code class="docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord.avg_gas_in_date_range()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_frac_remaining_by_age"><code class="docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord.get_frac_remaining_by_age()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_gas_by_age"><code class="docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord.get_gas_by_age()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_gas_by_month"><code class="docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord.get_gas_by_month()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_gas_for_dates"><code class="docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord.get_gas_for_dates()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_mlo_smo_mean"><code class="docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord.get_mlo_smo_mean()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_strat_gas"><code class="docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord.get_strat_gas()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.lat_bias_correction"><code class="docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord.lat_bias_correction()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.list_strat_dependent_files"><code class="docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord.list_strat_dependent_files()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.read_insitu_gas"><code class="docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord.read_insitu_gas()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.N2OTropicsRecord"><code class="docutils literal notranslate"><span class="pre">N2OTropicsRecord</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.N2OTropicsRecord.get_frac_remaining_by_age"><code class="docutils literal notranslate"><span class="pre">N2OTropicsRecord.get_frac_remaining_by_age()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ginput.priors.tccon_priors.N2OTropicsRecord.list_strat_dependent_files"><code class="docutils literal notranslate"><span class="pre">N2OTropicsRecord.list_strat_dependent_files()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.add_strat_prior_standard"><code class="docutils literal notranslate"><span class="pre">add_strat_prior_standard()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.add_trop_prior_standard"><code class="docutils literal notranslate"><span class="pre">add_trop_prior_standard()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.generate_full_tccon_vmr_file"><code class="docutils literal notranslate"><span class="pre">generate_full_tccon_vmr_file()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.generate_single_tccon_prior"><code class="docutils literal notranslate"><span class="pre">generate_single_tccon_prior()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.generate_tccon_priors_driver"><code class="docutils literal notranslate"><span class="pre">generate_tccon_priors_driver()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.get_clams_age"><code class="docutils literal notranslate"><span class="pre">get_clams_age()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.get_trop_eq_lat"><code class="docutils literal notranslate"><span class="pre">get_trop_eq_lat()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.modify_strat_co"><code class="docutils literal notranslate"><span class="pre">modify_strat_co()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ginput.priors.tccon_priors.regenerate_gas_strat_lut_files"><code class="docutils literal notranslate"><span class="pre">regenerate_gas_strat_lut_files()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mlo_smo_prep.html">mlo_smo_prep module</a></li>
<li class="toctree-l1"><a class="reference internal" href="acos_interface.html">acos_interface module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ginput</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>tccon_priors module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/tccon_priors.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-ginput.priors.tccon_priors">
<span id="tccon-priors-module"></span><h1>tccon_priors module<a class="headerlink" href="#module-ginput.priors.tccon_priors" title="Permalink to this heading"></a></h1>
<p>Main module for generating TCCON trace gas priors.</p>
<p>This module is the main driver to construct priors for CO2, CO, CH4, N2O, and HF for the TCCON retrieval. Broadly, each
gas follows a similar scheme:</p>
<ul class="simple">
<li><p>In the troposphere, the historical record for the gas is obtained from NOAA flask observations at Mauna Loa and Samoa
(MLO/SMO). This record is deseasonalized by taking a 12 month running mean of the data. The age-of-air in the
observation profile is calculated using a parameterization developed empirically from various in situ measurements for
previous versions of the GGG package. That age is then used to determine what date in the MLO/SMO should be looked up.
A parameterized seasonal cycle (again, developed for previous versions of GGG from in situ observations) is applied.
We use the parameterized seasonal cycle, rather than the real seasonal cycle in the MLO/SMO record, because the latter
will not capture any latitudinal dependence.</p></li>
<li><p>In the stratosphere, concentrations are calculated as the convolution of an age spectrum with the two month-lagged
MLO/SMO record. That is, for different mean ages of air, there are defined spectra that provide the contribution of
different ages to that air parcel. These can also be thought of as a probability distribution of age of air in a
given parcel. The trace gas concentration for a given age and date is the product of the age spectrum and the trace
gas record. A. Andrews derived different age spectra for tropics, midlatitudes, and polar vortex, therefore each
level of the profile must be classified into one of these three regions by latitude, day of year, and age.</p></li>
<li><p>In the middle world (above the tropopause &amp; theta &lt; 380 K), the profiles are interpolate with respect to theta between
the tropopause and the first overworld level.</p></li>
</ul>
<p>The stratospheric approach was developed by Arlyn Andrews, based on her research in Andrews et al. 2001 (JGR, 106 [D23],
pp. 32295-32314). For gases other than CO2, chemical loss or production in the stratosphere must be accounted for.</p>
<ul class="simple">
<li><p>For N2O, the relationship of N2O vs. age of air from Andrews et al. (2001) was recast as fraction of N2O remaining vs.
age, which allows us to use the MLO/SMO record directly rather than apply a growth factor. That is, in A. Andrews
code, she uses a function to calculate the N2O concentration based on age from a relationship derived in the 1990s,
then adds a growth factor to account for increase in N2O concentration since the 1990s. We instead use MLO/SMO to
get the stratospheric boundary condition, then multiply by the fraction remaining vs. age to get the actual
concentration. This allows us to use the MLO/SMO record to get the growth, rather than having to calculate a growth
rate separately.</p></li>
<li><p>For CH4, we use ACE-FTS data to derive a CH4-N2O relationship. Again, this is in terms of fraction remaining for both
CH4 and N2O.  Therefore for a given age, we find the fraction of N2O remaining and then use the ACE-FTS relationship
to convert that to a fraction of CH4 remaining. Since the F(CH4):F(N2O) relationship varies with potential
temperature, the CH4 lookup table includes a theta dependence.</p></li>
<li><p>For HF, we use relationships between HF and CH4 concentration derived in Saad et al. (2014,
doi: 10.5194/amt-7-2907-2014) and Washenfelder et al. (2003, doi: 10.1029/2003GL017969). These papers derive a slope
of CH4 concentration vs. HF concentration. Saad et al. find variations in the slope with latitude; for consistency
with the other gases, we use the tropics/midlatitudes/polar vortex regions rather than the latitude bins defined in
Saad et al. We rederive our own slopes during the ACE-FTS era (from ~2004) for these three bins, then prepend the
slopes back to ~1977 from Washenfelder et al. and fit the slope vs. time with an exponential. The HF code is set up
to use the ACE-FTS derived slopes directly in years where they are available and slopes derived from the exponential
fit outside the ACE window. The HF concentrations are calculated from CH4 concentrations assuming a linear
relationship where the y-intercept is assumed to be the normal two month-lagged MLO/SMO stratospheric boundary
condition and the slope is that precomputed from the ACE-FTS data or Washenfelder et al. Unlike N2O and CH4, fraction
remaining was not used since the Washenfelder et al. results make clear the CH4/HF relationship changes substantially
with time and we do not have ACE-FTS data to derive the F(CH4)/F(HF) relationship before 2004, after which the
change in slope vs. time is essentially flat.</p></li>
</ul>
<p><a class="reference internal" href="#ginput.priors.tccon_priors.generate_single_tccon_prior" title="ginput.priors.tccon_priors.generate_single_tccon_prior"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_single_tccon_prior()</span></code></a> is the primary function to use to create a single prior. It is used for all gases</p>
<dl class="py class">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.CH4TropicsRecord">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">CH4TropicsRecord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">first_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlo_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smo_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strat_age_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recalculate_strat_lut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_strat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recalc_if_custom_dates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.CH4TropicsRecord" title="Permalink to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.CH4TropicsRecord.add_strat_prior">
<span class="sig-name descname"><span class="pre">add_strat_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prof_gas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retrieval_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod_data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.CH4TropicsRecord.add_strat_prior" title="Permalink to this definition"></a></dt>
<dd><p>Add the tropospheric component of the prior.</p>
<p>See the help for <a class="reference internal" href="#ginput.priors.tccon_priors.add_strat_prior_standard" title="ginput.priors.tccon_priors.add_strat_prior_standard"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_strat_prior_standard()</span></code></a> in this module. All the inputs and outputs are the same except
that <code class="docutils literal notranslate"><span class="pre">gas_record</span></code> will be given this instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.CH4TropicsRecord.get_frac_remaining_by_age">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_frac_remaining_by_age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ages</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.CH4TropicsRecord.get_frac_remaining_by_age" title="Permalink to this definition"></a></dt>
<dd><p>Get the fraction of a gas remaining for a given vector of ages.</p>
<p>The default is to assume no loss, and so 1 will be returned for every age. Subclasses
may override this method to calculate more complicated relationships between age and fraction remaining.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ages</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or float) – the vector of ages to calculate the fraction of the gas remaining for</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a data frame indexed by age with one column, “fraction” containing the fraction remaining.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.CH4TropicsRecord.lat_bias_correction">
<span class="sig-name descname"><span class="pre">lat_bias_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.CH4TropicsRecord.lat_bias_correction" title="Permalink to this definition"></a></dt>
<dd><p>Returns a latitudinal bias correction to add to the prior</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_date</strong> (<em>datetime-like</em>) – the date of the observation</p></li>
<li><p><strong>obs_lat</strong> (<em>float</em>) – the latitude of the observation</p></li>
<li><p><strong>mod_data</strong> (<em>dict</em>) – the dictionary of data read in from the .mod file</p></li>
<li><p><strong>prior_data</strong> (<em>dict</em>) – a dictionary of data calculated for the prior, including the keys: “age_of_air” (the
tropospheric age of air profile), “adj_zgrid” (the adjusted altitude grid used for the tropospheric prior) and
“z_trop” (the tropopause height).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a float or float array to add to the prior profile to correct latitudinally-dependent biases in the
troposphere.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or array-like</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.CO2TropicsRecord">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">CO2TropicsRecord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">first_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlo_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smo_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strat_age_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recalculate_strat_lut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_strat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recalc_if_custom_dates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.CO2TropicsRecord" title="Permalink to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.CO2TropicsRecord.lat_bias_correction">
<span class="sig-name descname"><span class="pre">lat_bias_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.CO2TropicsRecord.lat_bias_correction" title="Permalink to this definition"></a></dt>
<dd><p>Returns a latitudinal bias correction to add to the prior</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_date</strong> (<em>datetime-like</em>) – the date of the observation</p></li>
<li><p><strong>obs_lat</strong> (<em>float</em>) – the latitude of the observation</p></li>
<li><p><strong>mod_data</strong> (<em>dict</em>) – the dictionary of data read in from the .mod file</p></li>
<li><p><strong>prior_data</strong> (<em>dict</em>) – a dictionary of data calculated for the prior, including the keys: “age_of_air” (the
tropospheric age of air profile), “adj_zgrid” (the adjusted altitude grid used for the tropospheric prior) and
“z_trop” (the tropopause height).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a float or float array to add to the prior profile to correct latitudinally-dependent biases in the
troposphere.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or array-like</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.GasRecordDateError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">GasRecordDateError</span></span><a class="headerlink" href="#ginput.priors.tccon_priors.GasRecordDateError" title="Permalink to this definition"></a></dt>
<dd><p>Error to raise for any issues with dates in the gas records</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.GasRecordError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">GasRecordError</span></span><a class="headerlink" href="#ginput.priors.tccon_priors.GasRecordError" title="Permalink to this definition"></a></dt>
<dd><p>Base error for problems in the CO2 record</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.GasRecordExtrapolationError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">GasRecordExtrapolationError</span></span><a class="headerlink" href="#ginput.priors.tccon_priors.GasRecordExtrapolationError" title="Permalink to this definition"></a></dt>
<dd><p>Error to raise if there’s a problem with the extrapolation of the MLO/SMO records.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.GasRecordInconsistentDimsError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">GasRecordInconsistentDimsError</span></span><a class="headerlink" href="#ginput.priors.tccon_priors.GasRecordInconsistentDimsError" title="Permalink to this definition"></a></dt>
<dd><p>Error when arrays in a gas record have different dimensions and are not supposed to</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.GasRecordInputMissingError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">GasRecordInputMissingError</span></span><a class="headerlink" href="#ginput.priors.tccon_priors.GasRecordInputMissingError" title="Permalink to this definition"></a></dt>
<dd><p>Error to use when cannot find the necessary input files for a trace gas record</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.GasRecordInputVerificationError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">GasRecordInputVerificationError</span></span><a class="headerlink" href="#ginput.priors.tccon_priors.GasRecordInputVerificationError" title="Permalink to this definition"></a></dt>
<dd><p>Error when the input could not be verified (i.e. if hashes don’t match)</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.HFTropicsRecord">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">HFTropicsRecord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">first_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlo_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smo_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strat_age_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recalculate_strat_lut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_strat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recalc_if_custom_dates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.HFTropicsRecord" title="Permalink to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.HFTropicsRecord.add_extra_column">
<span class="sig-name descname"><span class="pre">add_extra_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prof_gas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retrieval_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod_data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.HFTropicsRecord.add_extra_column" title="Permalink to this definition"></a></dt>
<dd><p>Add a representation of out-of-range column density to the prior</p>
<p>This method is intended for use to handle cases like CO, which has a fairly large mesospheric column that can’t
be directly represented in the prior. It will add extra concentration to one or more levels in the prior such
that, when integrated, the extra column density is accounted for. Ideally, this should be called after
interpolating to the final levels that the priors will be used on in GGG so that the column can be reproduced
exactly by the integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prof_gas</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – the profile to modify. Modified in-place</p></li>
<li><p><strong>retrieval_date</strong> – the date/time of the prior profile (unused, present for consistency)</p></li>
<li><p><strong>mod_data</strong> (<em>dict</em>) – the dictionary of model data read in from the .mod file.</p></li>
<li><p><strong>kwargs</strong> – unused, swallows extra keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the modified gas profile and a dictionary on ancillary information (currently empty).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.HFTropicsRecord.get_mlo_smo_mean">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_mlo_smo_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mlo_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smo_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate_date</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.HFTropicsRecord.get_mlo_smo_mean" title="Permalink to this definition"></a></dt>
<dd><p>Generate the Mauna Loa/Samoa mean trace gas record.</p>
<p>For HF, there is no MLO/SMO record because it has no presence in the troposphere. Since this method is called
by __init__ to set the seasonal cycle concentration, we override it to just create a data frame with the correct
format but with concentrations of 0 for all times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mlo_file</strong> (<em>str</em>) – unused, kept for consistency with other TraceGasTropicsRecord subclasses</p></li>
<li><p><strong>smo_file</strong> (<em>str</em>) – unused, kept for consistency with other TraceGasTropicsRecord subclasses</p></li>
<li><p><strong>first_date</strong> (<em>datetime-like</em>) – the earliest date to use in the record. Note that the actual first date will always be the
first of the month for this date.</p></li>
<li><p><strong>last_date</strong> (<em>datetime-like</em>) – the latest date to include in the record. Note that if it is not the first of the month, then
the actual latest date used would be the next first of the month to follow this date. I.e. if this is June
15th, then July 1st would be used instead.</p></li>
<li><p><strong>truncate_date</strong> – unused, since HF has no MLO/SMO data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the data frame containing the mean trace gas concentration (‘dmf_mean’), a flag (‘interp_flag’) set
to 1 for any months that had to be interpolated and 2 for months that had to be extrapolated, and the latency
(‘latency’) in years that a concentration had to be extrapolated. Index by timestamp.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.HFTropicsRecord.list_strat_dependent_files">
<span class="sig-name descname"><span class="pre">list_strat_dependent_files</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.HFTropicsRecord.list_strat_dependent_files" title="Permalink to this definition"></a></dt>
<dd><p>Return a dictionary describing the files that the stratospheric LUT depends on.</p>
<p>This dictionary will have the keys be the attribute names to use in the LUT netCDF file and the values be the
paths to the files that the LUT depends on. Each file’s SHA1 hash will get stored in the netCDF file under
the global attribute named by its key.</p>
<p>For most trace gas records, this will be the Mauna Loa and Samoa flask data files. However, if certain
trace gas records depend on other files, this method should be overridden to return the proper dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.MloSmoTraceGasRecord">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">MloSmoTraceGasRecord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">first_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlo_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smo_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strat_age_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recalculate_strat_lut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_strat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recalc_if_custom_dates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord" title="Permalink to this definition"></a></dt>
<dd><p>This class stores the Mauna Loa/Samoa average CO2 record and provides methods to sample it.</p>
<p>Initialization arguments:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>first_date</strong> (<em>datetime-like</em>) – optional, the first date required in the concentration records. The actual first date will be
before this, as the age spectra calculation require ~30 years of data preceding each date, therefore the simple
time series records will be extended to <code class="docutils literal notranslate"><span class="pre">first_date</span></code> - 30 years. If not given, then 1 Jan 2000 is assumed
(meaning the actual first date will be 1 Jan 1970). The date will always be moved to the first of a month.</p></li>
<li><p><strong>last_date</strong> (<em>datetime-like</em>) – optional, the last date required in the concentration records. The date will always be moved to
the first of a month. If omitted, a date two years from today is used. Unlike <code class="docutils literal notranslate"><span class="pre">first_date</span></code>, there is no
modification to account for the needs of the age spectra.</p></li>
<li><p><strong>truncate_date</strong> – the last date to use <em>real data</em> for in the record, after this date the MLO/SMO time
series will be extrapolated. Note that this is inclusive.</p></li>
<li><p><strong>lag</strong> (<em>timedelta-like</em>) – optional, the lag between Mauna Loa/Samoa measurements and the stratospheric boundary condition. Default
is two months, i.e. the stratospheric boundary condition for a given date is assumed to be that measured at MLO/SMO
two months previously.</p></li>
<li><p><strong>mlo_file</strong> (<em>str</em>) – optional, the path to the Mauna Loa flask data file. Must be formatted as a NOAA monthly flask data
file, where the first line is “# f_header_lines: n” (n being the number of header lines) and the data being
organized in four columns (space separated): site, year, month, value.</p></li>
<li><p><strong>smo_file</strong> (<em>str</em>) – optional, the path to the Samoa flask data file. Same format as the MLO file required.</p></li>
<li><p><strong>recalculate_strat_lut</strong> (<em>bool</em><em> or </em><em>None</em>) – optional, set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to force the stratospheric concentrations look up table
to be recalculated or <code class="docutils literal notranslate"><span class="pre">False</span></code> to always use the existing lookup table if it exists. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>, which
will check if any of the files that the LUT depends on have changed, and recalculate it if so.</p></li>
<li><p><strong>save_strat</strong> (<em>bool</em><em> or </em><em>None</em>) – optional, set to <code class="docutils literal notranslate"><span class="pre">False</span></code> to avoid saving the stratospheric concentration lookup if it is
recalculated. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>, which will save the LUT if recalculated unless it was recalculated to cover the
time frame requested. This option has no effect if the stratospheric lookup table is read from the netCDF file.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.MloSmoTraceGasRecord.add_extra_column">
<span class="sig-name descname"><span class="pre">add_extra_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prof_gas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retrieval_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod_data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.add_extra_column" title="Permalink to this definition"></a></dt>
<dd><p>Add a representation of out-of-range column density to the prior</p>
<p>This method is intended for use to handle cases like CO, which has a fairly large mesospheric column that can’t
be directly represented in the prior. It will add extra concentration to one or more levels in the prior such
that, when integrated, the extra column density is accounted for. Ideally, this should be called after
interpolating to the final levels that the priors will be used on in GGG so that the column can be reproduced
exactly by the integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prof_gas</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – the profile to modify. Modified in-place</p></li>
<li><p><strong>retrieval_date</strong> – the date/time of the prior profile (unused, present for consistency)</p></li>
<li><p><strong>mod_data</strong> (<em>dict</em>) – the dictionary of model data read in from the .mod file.</p></li>
<li><p><strong>kwargs</strong> – unused, swallows extra keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the modified gas profile and a dictionary on ancillary information (currently empty).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.MloSmoTraceGasRecord.add_strat_prior">
<span class="sig-name descname"><span class="pre">add_strat_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prof_gas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retrieval_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod_data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.add_strat_prior" title="Permalink to this definition"></a></dt>
<dd><p>Add the tropospheric component of the prior.</p>
<p>See the help for <a class="reference internal" href="#ginput.priors.tccon_priors.add_strat_prior_standard" title="ginput.priors.tccon_priors.add_strat_prior_standard"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_strat_prior_standard()</span></code></a> in this module. All the inputs and outputs are the same except
that <code class="docutils literal notranslate"><span class="pre">gas_record</span></code> will be given this instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.MloSmoTraceGasRecord.add_trop_prior">
<span class="sig-name descname"><span class="pre">add_trop_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prof_gas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_adjusted_zgrid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.add_trop_prior" title="Permalink to this definition"></a></dt>
<dd><p>Add the tropospheric component of the prior.</p>
<p>See the help for <a class="reference internal" href="#ginput.priors.tccon_priors.add_trop_prior_standard" title="ginput.priors.tccon_priors.add_trop_prior_standard"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_trop_prior_standard()</span></code></a> in this module. All the inputs and outputs are the same except
that <code class="docutils literal notranslate"><span class="pre">gas_record</span></code> will be given this instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.MloSmoTraceGasRecord.avg_gas_in_date_range">
<span class="sig-name descname"><span class="pre">avg_gas_in_date_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deseasonalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.avg_gas_in_date_range" title="Permalink to this definition"></a></dt>
<dd><p>Average the MLO/SMO record between the given dates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_date</strong> (<em>datetime-like object</em>) – the first date in the averaging period</p></li>
<li><p><strong>end_date</strong> (<em>datetime-like object</em>) – the last date in the averaging period</p></li>
<li><p><strong>deseasonalize</strong> (<em>bool</em>) – whether to draw concentration data from the trend only (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or the seasonal cycle
(<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the average concentration and a dictionary specifying the mean, minimum, and maximum latency
(number of years the concentrations had to be extrapolated)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float, dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_frac_remaining_by_age">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_frac_remaining_by_age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ages</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_frac_remaining_by_age" title="Permalink to this definition"></a></dt>
<dd><p>Get the fraction of a gas remaining for a given vector of ages.</p>
<p>The default is to assume no loss, and so 1 will be returned for every age. Subclasses
may override this method to calculate more complicated relationships between age and fraction remaining.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ages</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or float) – the vector of ages to calculate the fraction of the gas remaining for</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a data frame indexed by age with one column, “fraction” containing the fraction remaining.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_gas_by_age">
<span class="sig-name descname"><span class="pre">get_gas_by_age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deseasonalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dataframe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_gas_by_age" title="Permalink to this definition"></a></dt>
<dd><p>Get concentrations for one or more times by specifying a reference date and age.</p>
<p>This called <a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_gas_for_dates" title="ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_gas_for_dates"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_gas_for_dates()</span></code></a> internally, so the concentration is interpolated to the specific day just
as that method does.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_date</strong> (<em>datetime-like object.</em>) – the date that the ages are relative to.</p></li>
<li><p><strong>age</strong> (<em>float</em><em> or </em><em>sequence</em><em> of </em><em>floats</em>) – the number of years before the reference date to get the concentration from. May be a non-whole
number.</p></li>
<li><p><strong>deseasonalize</strong> (<em>bool</em>) – whether to draw concentration data from the trend only (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or the seasonal cycle
(<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
<li><p><strong>as_dataframe</strong> (<em>bool</em>) – whether to return the concentration data as a dataframe (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or numpy array
(<code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the concentration data for the requested date(s), as a numpy vector or data frame. The data frame will
also include the latency (how many years the concentrations had to be extrapolated).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_gas_by_month">
<span class="sig-name descname"><span class="pre">get_gas_by_month</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deseasonalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_gas_by_month" title="Permalink to this definition"></a></dt>
<dd><p>Get the trace gas concentration for a specific month</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>year</strong> (<em>int</em>) – the date’s year</p></li>
<li><p><strong>month</strong> (<em>int</em>) – the date’s month</p></li>
<li><p><strong>deseasonalize</strong> (<em>bool</em>) – whether to draw concentration data from the trend only (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or the seasonal cycle
(<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the gas concentration and a dictionary with additional information (e.g. the latency, that is, how far
the concentrations had to be extrapolated).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float, dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_gas_for_dates">
<span class="sig-name descname"><span class="pre">get_gas_for_dates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deseasonalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dataframe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_gas_for_dates" title="Permalink to this definition"></a></dt>
<dd><p>Get trace gas concentrations for one or more dates.</p>
<p>This method will lookup concentrations for a specific date or dates, interpolating between the monthly values as
necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dates</strong> – the date or dates to get concentrations for. If giving a single date, it may be any time that can
be converted to a Pandas <code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code>. If giving a series of dates, it must be a
<code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DatetimeIndex</span></code>.</p></li>
<li><p><strong>deseasonalize</strong> (<em>bool</em>) – whether to draw concentrations data from the trend only (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or the seasonal cycle
(<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
<li><p><strong>as_dataframe</strong> (<em>bool</em>) – whether to return the concentrations data as a dataframe (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or numpy array
(<code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the concentration data for the requested date(s), as a numpy vector or data frame. The data frame will
also include the latency (how many years the concentrations had to be extrapolated).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_mlo_smo_mean">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_mlo_smo_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mlo_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smo_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate_date</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_mlo_smo_mean" title="Permalink to this definition"></a></dt>
<dd><p>Generate the Mauna Loa/Samoa mean trace gas record from the files stored in this repository.</p>
<p>Reads in the given Mauna Loa and Samoa record files, averages then, fills in missing values by interpolation,
extrapolates as needed to provide the full record requested, and returns the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mlo_file</strong> (<em>str</em>) – the name (not the full path) of the Mauna Loa flask data file that is included in the repo
data directory.</p></li>
<li><p><strong>smo_file</strong> (<em>str</em>) – the name (not the full path) of the Samoa flask data file that is included in the repo
data directory.</p></li>
<li><p><strong>first_date</strong> (<em>datetime-like</em>) – the earliest date to use in the record. Note that the actual first date will always be the
first of the month for this date.</p></li>
<li><p><strong>last_date</strong> (<em>datetime-like</em>) – the latest date to include in the record. Note that if it is not the first of the month, then
the actual latest date used would be the next first of the month to follow this date. I.e. if this is June
15th, then July 1st would be used instead.</p></li>
<li><p><strong>truncate_date</strong> – the last date to use <em>real data</em> for in the record, after this date the MLO/SMO time
series will be extrapolated. Note that this is inclusive.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the data frame containing the mean trace gas concentration (‘dmf_mean’), a flag (‘interp_flag’) set
to 1 for any months that had to be interpolated and 2 for months that had to be extrapolated, and the latency
(‘latency’) in years that a concentration had to be extrapolated. Index by timestamp.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the data frame containing the mean trace gas concentration (‘dmf_mean’) and a flag (‘interp_flag’) set
to 1 for any months that had to be interpolated. Index by timestamp.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_strat_gas">
<span class="sig-name descname"><span class="pre">get_strat_gas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ages</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eqlat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dataframe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.get_strat_gas" title="Permalink to this definition"></a></dt>
<dd><p>Get stratospheric gas concentration for a given profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> (<em>datetime-like</em>) – the UTC date of the observation</p></li>
<li><p><strong>ages</strong> (<em>array-like</em>) – the age or ages of air (in years) to get concentration for. Must be the same shape as <code class="docutils literal notranslate"><span class="pre">eqlat</span></code>.</p></li>
<li><p><strong>eqlat</strong> (<em>array-like</em>) – the equivalent latitude or eq. lat profile to get concentration for. Must be the same shape as
<code class="docutils literal notranslate"><span class="pre">ages</span></code>.</p></li>
<li><p><strong>theta</strong> – the potential temperature profile associated with the prior. Only required if the</p></li>
<li><p><strong>as_dataframe</strong> (<em>bool</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the gas concentration will be returned as a data frame. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, it will
be returned as an array if <code class="docutils literal notranslate"><span class="pre">ages</span></code> and <code class="docutils literal notranslate"><span class="pre">eqlat</span></code> were arrays or a float if they were floats.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the gas concentration as a data frame, numpy array, or scalar, depending on <code class="docutils literal notranslate"><span class="pre">as_dataframe</span></code> and the
input types. Also returns None, a placeholder for future information about profile latency, etc.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float, <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, or <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.MloSmoTraceGasRecord.lat_bias_correction">
<span class="sig-name descname"><span class="pre">lat_bias_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.lat_bias_correction" title="Permalink to this definition"></a></dt>
<dd><p>Returns a latitudinal bias correction to add to the prior</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_date</strong> (<em>datetime-like</em>) – the date of the observation</p></li>
<li><p><strong>obs_lat</strong> (<em>float</em>) – the latitude of the observation</p></li>
<li><p><strong>mod_data</strong> (<em>dict</em>) – the dictionary of data read in from the .mod file</p></li>
<li><p><strong>prior_data</strong> (<em>dict</em>) – a dictionary of data calculated for the prior, including the keys: “age_of_air” (the
tropospheric age of air profile), “adj_zgrid” (the adjusted altitude grid used for the tropospheric prior) and
“z_trop” (the tropopause height).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a float or float array to add to the prior profile to correct latitudinally-dependent biases in the
troposphere.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.MloSmoTraceGasRecord.list_strat_dependent_files">
<span class="sig-name descname"><span class="pre">list_strat_dependent_files</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.list_strat_dependent_files" title="Permalink to this definition"></a></dt>
<dd><p>Return a dictionary describing the files that the stratospheric LUT depends on.</p>
<p>This dictionary will have the keys be the attribute names to use in the LUT netCDF file and the values be the
paths to the files that the LUT depends on. Each file’s SHA1 hash will get stored in the netCDF file under
the global attribute named by its key.</p>
<p>For most trace gas records, this will be the Mauna Loa and Samoa flask data files. However, if certain
trace gas records depend on other files, this method should be overridden to return the proper dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.MloSmoTraceGasRecord.read_insitu_gas">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_insitu_gas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_file_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord.read_insitu_gas" title="Permalink to this definition"></a></dt>
<dd><p>Read a trace gas record file. Assumes that the file is of monthly average concentrations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fpath</strong> (<em>str</em>) – the path to the directory containing the file.</p></li>
<li><p><strong>fname</strong> (<em>str</em>) – the name of the file</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a data frame containing the monthly trace gas data along with the site, year, month, and day. The index will
be a timestamp of the measurment time.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.N2OTropicsRecord">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">N2OTropicsRecord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">first_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlo_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smo_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strat_age_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recalculate_strat_lut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_strat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recalc_if_custom_dates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.N2OTropicsRecord" title="Permalink to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.N2OTropicsRecord.get_frac_remaining_by_age">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_frac_remaining_by_age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ages</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.N2OTropicsRecord.get_frac_remaining_by_age" title="Permalink to this definition"></a></dt>
<dd><p>Get the fraction of a gas remaining for a given vector of ages.</p>
<p>The default is to assume no loss, and so 1 will be returned for every age. Subclasses
may override this method to calculate more complicated relationships between age and fraction remaining.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ages</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or float) – the vector of ages to calculate the fraction of the gas remaining for</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a data frame indexed by age with one column, “fraction” containing the fraction remaining.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.N2OTropicsRecord.list_strat_dependent_files">
<span class="sig-name descname"><span class="pre">list_strat_dependent_files</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.N2OTropicsRecord.list_strat_dependent_files" title="Permalink to this definition"></a></dt>
<dd><p>Return a dictionary describing the files that the stratospheric LUT depends on.</p>
<p>This dictionary will have the keys be the attribute names to use in the LUT netCDF file and the values be the
paths to the files that the LUT depends on. Each file’s SHA1 hash will get stored in the netCDF file under
the global attribute named by its key.</p>
<p>For most trace gas records, this will be the Mauna Loa and Samoa flask data files. However, if certain
trace gas records depend on other files, this method should be overridden to return the proper dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.add_strat_prior_standard">
<span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">add_strat_prior_standard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prof_gas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retrieval_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_record</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profs_latency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prof_aoa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prof_world_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_record_dates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.add_strat_prior_standard" title="Permalink to this definition"></a></dt>
<dd><p>Add the stratospheric trace gas to a TCCON prior profile using the standard approach.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prof_gas</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> (in ppm)) – the profile trace gase mixing ratios. Will be modified in-place to add the stratospheric
component.</p></li>
<li><p><strong>retrieval_date</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code>) – the UTC date of the retrieval.</p></li>
<li><p><strong>gas_record</strong> (<a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord" title="ginput.priors.tccon_priors.MloSmoTraceGasRecord"><code class="xref py py-class docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord</span></code></a>) – the Mauna Loa-Samoa CO2 record.</p></li>
</ul>
</dd>
</dl>
<p>The following parameters are all optional; they are vectors that will be filled with the appropriate values in the
stratosphere. The are also returned in the ancillary dictionary; if not given as inputs, they are initialized with
NaNs. “nlev” below means the number of levels in the CO2 profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>profs_latency</strong> – nlev-by-3 array that will store how far forward in time the Mauna Loa/Samoa CO2 record had to
be extrapolated, in years. The three columns will respectively contain the mean, min, and max latency.</p></li>
<li><p><strong>prof_aoa</strong> – nlev-element vector of ages of air, in years.</p></li>
<li><p><strong>prof_world_flag</strong> – nlev-element vector of ints which will indicate which levels are considered overworld and
which middleworld. The values used for each are defined in <code class="xref py py-mod docutils literal notranslate"><span class="pre">mod_constants</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated CO2 profile and a dictionary of the ancillary profiles.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.add_trop_prior_standard">
<span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">add_trop_prior_standard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prof_gas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_record</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_lat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_theta_eqlat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profs_latency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prof_aoa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prof_world_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prof_gas_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_adjusted_zgrid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.add_trop_prior_standard" title="Permalink to this definition"></a></dt>
<dd><p>Add troposphere concentration to the prior profile using the standard approach.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prof_gas</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – the profile trace gas mixing ratios. Will be modified in-place to add the stratospheric
component.</p></li>
<li><p><strong>obs_date</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code>) – the UTC date of the retrieval.</p></li>
<li><p><strong>obs_lat</strong> (<em>float</em>) – the latitude of the retrieval (degrees, south is negative)</p></li>
<li><p><strong>gas_record</strong> (<a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord" title="ginput.priors.tccon_priors.MloSmoTraceGasRecord"><code class="xref py py-class docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord</span></code></a>) – the Mauna Loa-Samoa record for the desired gas.</p></li>
<li><p><strong>mod_data</strong> – the dictionary of .mod file data. Must have the tropo</p></li>
<li><p><strong>ref_lat</strong> (<em>float.</em>) – the reference latitude for age of air. Effectively sets where the age begins, i.e where the
emissions are.</p></li>
<li><p><strong>use_theta_eqlat</strong> (<em>bool</em>) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to use an equivalent latitude derive from the mid-tropospheric potential
temperature as the latitude in the age of air and seasonal cycle calculations. This helps correct overly curved
profiles at sites near the tropics that sometimes have more tropical-like profiles depending on synoptic scale
transport. If this is <code class="docutils literal notranslate"><span class="pre">False</span></code>, then <code class="docutils literal notranslate"><span class="pre">obs_lat</span></code> is used directly.</p></li>
</ul>
</dd>
</dl>
<p>The following parameters are all optional; they are vectors that will be filled with the appropriate values in the
stratosphere. The are also returned in the ancillary dictionary; if not given as inputs, they are initialized with
NaNs. “nlev” below means the number of levels in the CO2 profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>profs_latency</strong> – nlev-by-3 array that will store how far forward in time the Mauna Loa/Samoa CO2 record had to
be extrapolated, in years. The three columns will respectively contain the mean, min, and max latency.</p></li>
<li><p><strong>prof_aoa</strong> – nlev-element vector of ages of air, in years.</p></li>
<li><p><strong>prof_world_flag</strong> – nlev-element vector of ints which will indicate which levels are considered overworld and
which middleworld. The values used for each are defined in <code class="xref py py-mod docutils literal notranslate"><span class="pre">mod_constants</span></code></p></li>
<li><p><strong>prof_gas_date</strong> – nlev-element vector that stores the date in the MLO/SMO record that the gas was taken from.
Since most levels will have a window of dates, this is the middle of those windows. The dates are stored as a
datetime object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated CO2 profile and a dictionary of the ancillary profiles.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.generate_full_tccon_vmr_file">
<span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">generate_full_tccon_vmr_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mod_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utc_offsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">product</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fpit'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_vmr_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_abbrevs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xx'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_latlon_prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_existing_luts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.generate_full_tccon_vmr_file" title="Permalink to this definition"></a></dt>
<dd><p>Generate a .vmr file with all the gases required by TCCON (both retrieved and secondary).</p>
<p><code class="docutils literal notranslate"><span class="pre">mod_data</span></code>, <code class="docutils literal notranslate"><span class="pre">utc_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">site_abbrevs</span></code> may be single values or collections. See
<a class="reference internal" href="#ginput.priors.tccon_priors.generate_tccon_priors_driver" title="ginput.priors.tccon_priors.generate_tccon_priors_driver"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_tccon_priors_driver()</span></code></a> in this module for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mod_data</strong> (<em>dict</em><em> or </em><em>str</em>) – a dictionary mimicking that from reading a .mod file or the path to a .mod file</p></li>
<li><p><strong>utc_offsets</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.timedelta</span></code> or list(<code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.timedelta</span></code>)) – difference(s) between local time and UTC time for each site</p></li>
<li><p><strong>save_dir</strong> (<em>str</em>) – where to save the .vmr files</p></li>
<li><p><strong>std_vmr_file</strong> (<em>None</em><em>, </em><em>str</em><em>, or </em><em>bool</em>) – a standard .vmr file that has profiles for all the gases needed by TCCON, as well as their
seasonal cycles, latitudinal gradients, and secular trends. These profiles are assumed to be base profiles
representative of one latitude/time that can be modified for other locations/times. If this is not given, then the
code will try to look for <code class="docutils literal notranslate"><span class="pre">$GGGPATH/vmrs/gnd/summer_35N.vmr</span></code>. If you do not have <code class="docutils literal notranslate"><span class="pre">GGGPATH</span></code> defined as an
environmental variable, it will error. You may pass an explicit path to a .vmr file to override that, or <code class="docutils literal notranslate"><span class="pre">False</span></code>
to only write the primary gases to the .vmr file.</p></li>
<li><p><strong>site_abbrevs</strong> (<em>str</em><em> or </em><em>list</em><em>(</em><em>str</em><em>)</em>) – abbreviation or list of abbreviations for the sites the .vmr files are being written for.</p></li>
<li><p><strong>keep_latlon_prec</strong> (<em>bool</em>) – by default, latitude/longitude in the .vmr filenames is rounded to the nearest integer.
Set this to <code class="docutils literal notranslate"><span class="pre">True</span></code> to keep 2 decimal places of precision.</p></li>
<li><p><strong>use_existing_luts</strong> (<em>bool</em>) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to avoid recalculating stratospheric LUTs for the MLO/SMO records. Doing
so will make it much faster for this to start, but risks using an out-of-date LUT that was generated with old code
or input data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>none, writes .vmr files</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>GGGPathError</strong> – if <code class="docutils literal notranslate"><span class="pre">$GGGPATH</span></code> is not defined and it needs to find the standard file or it cannot find the
standard file in the expected place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.generate_single_tccon_prior">
<span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">generate_single_tccon_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mod_file_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utc_offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concentration_record</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgrid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_eqlat_trop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_eqlat_strat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_adjusted_zgrid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.generate_single_tccon_prior" title="Permalink to this definition"></a></dt>
<dd><p>Driver function to generate the TCCON prior profiles for a single observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mod_file_data</strong> (<em>str</em><em> or </em><em>dict</em>) – data from a .mod file prepared by Mod Maker. May either be a path to a .mod file, or a
dictionary from <code class="xref py py-func docutils literal notranslate"><span class="pre">read_mod_file()</span></code>.</p></li>
<li><p><strong>utc_offset</strong> – a timedelta giving the difference between the <code class="docutils literal notranslate"><span class="pre">file_date</span></code> and UTC time. For example, if the
<code class="docutils literal notranslate"><span class="pre">file_date</span></code> was given in US Pacific Standard Time, this should be <code class="docutils literal notranslate"><span class="pre">timedelta(hours=-8)</span></code>. This is used to
correct the date to UTC to ensure the CO2 from the right time is used.</p></li>
<li><p><strong>concentration_record</strong> (str or <a class="reference internal" href="#ginput.priors.tccon_priors.MloSmoTraceGasRecord" title="ginput.priors.tccon_priors.MloSmoTraceGasRecord"><code class="xref py py-class docutils literal notranslate"><span class="pre">MloSmoTraceGasRecord</span></code></a>) – which species to generate the prior profile for. Must be the proper subclass of
TraceGasTropicsRecord for the given species. The latter is useful if you are making multiple calls to this
function, as it removes the need to instantiate the record during each call</p></li>
<li><p><strong>site_abbrev</strong> (<em>str</em>) – the two-letter site abbreviation. Currently only used in naming the output file.</p></li>
<li><p><strong>zgrid</strong> (str, <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, or <code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>) – specifies what altitude grid to interpolate the priors to. May be either a string pointing to an
<code class="file docutils literal notranslate"><span class="pre">integral*.gnd</span></code> file or an array of altitudes (in kilometers).</p></li>
<li><p><strong>use_eqlat_trop</strong> (<em>bool</em>) – when <code class="docutils literal notranslate"><span class="pre">True</span></code>, the latitude used for age-of-air and seasonal cycle calculations is calculate
based on the climatology of latitude vs. mid-tropospheric potential temperature. When <code class="docutils literal notranslate"><span class="pre">False</span></code>, the geographic
latitude of the observation is used.</p></li>
<li><p><strong>use_eqlat_strat</strong> (<em>bool</em>) – when <code class="docutils literal notranslate"><span class="pre">True</span></code>, the stratosphere profiles use equivalent latitude that must be given in the
mod data (requires the variable “EL” in the dictionary/mod file). Setting this to <code class="docutils literal notranslate"><span class="pre">False</span></code> uses the geographic
latitude of the observation instead. This allows you to skip the (fairly processor intensive) equivalent latitude
calculation when preparing the .mod files, but can lead to ~2% differences in CO2 near the tropopause (in March).</p></li>
<li><p><strong>use_adjusted_zgrid</strong> (<em>bool</em>) – when <code class="docutils literal notranslate"><span class="pre">True</span></code>, the altitude grid near the surface will be stretched or compressed in an
effort to match the lowest level of the 3D altitude grid to the surface altitude. When <code class="docutils literal notranslate"><span class="pre">False</span></code>, the altitude grid
is used as-is.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dictionary containing all the profiles (including many for debugging) and a dictionary containing the
units of the values in each profile.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict, dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.generate_tccon_priors_driver">
<span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">generate_tccon_priors_driver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mod_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utc_offsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_abbrevs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xx'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_vmrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_name_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_latlon_prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">product</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fpit'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">prior_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.generate_tccon_priors_driver" title="Permalink to this definition"></a></dt>
<dd><p>Generate multiple TCCON priors or a file containing multiple gas concentrations</p>
<p>This function wraps <a class="reference internal" href="#ginput.priors.tccon_priors.generate_single_tccon_prior" title="ginput.priors.tccon_priors.generate_single_tccon_prior"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_single_tccon_prior()</span></code></a>  in order to generate priors for one or more gases for one
or more sites. The inputs <code class="docutils literal notranslate"><span class="pre">mod_data</span></code>, <code class="docutils literal notranslate"><span class="pre">utc_offsets</span></code>, and <code class="docutils literal notranslate"><span class="pre">site_abbrevs</span></code> determine the number of
sites. Each of these must be either a single instance of the correct type or a collection of those types. Any of
them given as collections must have the same number of elements; those given as single instances will be used for
all profiles.</p>
<p>For example, say that you wanted to generate profiles for three days. <code class="docutils literal notranslate"><span class="pre">mod_data</span></code> would need to be a list of paths
to .mod files, but <code class="docutils literal notranslate"><span class="pre">utc_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">site_abbrevs</span></code> could be a single timedelta and string, respectively.</p>
<p><code class="docutils literal notranslate"><span class="pre">species</span></code> can likewise be a single instance or a collection, but in either case will be applied to all
sites/times. This determines which species will have profiles generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mod_data</strong> – input to <a class="reference internal" href="#ginput.priors.tccon_priors.generate_single_tccon_prior" title="ginput.priors.tccon_priors.generate_single_tccon_prior"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_single_tccon_prior()</span></code></a>, see that function.</p></li>
<li><p><strong>utc_offsets</strong> – input to <a class="reference internal" href="#ginput.priors.tccon_priors.generate_single_tccon_prior" title="ginput.priors.tccon_priors.generate_single_tccon_prior"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_single_tccon_prior()</span></code></a>, see that function.</p></li>
<li><p><strong>species</strong> (str, <code class="xref py py-class docutils literal notranslate"><span class="pre">TraceGasTropicsRecord</span></code>, list(str), or list(<code class="xref py py-class docutils literal notranslate"><span class="pre">TraceGasTropicsRecord</span></code>)) – either gas names as strings or instances of <code class="xref py py-class docutils literal notranslate"><span class="pre">TraceGasTropicsRecord</span></code> that set up which gases’
profiles are created. If given as a list, then all species given will be generated for each site/time.</p></li>
<li><p><strong>site_abbrevs</strong> – input to <a class="reference internal" href="#ginput.priors.tccon_priors.generate_single_tccon_prior" title="ginput.priors.tccon_priors.generate_single_tccon_prior"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_single_tccon_prior()</span></code></a>, see that function.</p></li>
<li><p><strong>write_vmrs</strong> – if <code class="docutils literal notranslate"><span class="pre">False</span></code>, then .vmr files are not written. If truthy, then it must be a path to the directory
where the .map files are to be written.</p></li>
<li><p><strong>gas_name_order</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – the order that the gases are to be written in in the output files. Currently only affects the
.vmr files. See <code class="xref py py-func docutils literal notranslate"><span class="pre">mod_utils.write_vmr_file()</span></code> for more information.</p></li>
<li><p><strong>keep_latlon_prec</strong> (<em>bool</em>) – if <code class="docutils literal notranslate"><span class="pre">False</span></code>, then .vmr files written are named with lat/lon rounded to integers. If
<code class="docutils literal notranslate"><span class="pre">True</span></code>, then 2 decimal places are retained.</p></li>
<li><p><strong>prior_kwargs</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.get_clams_age">
<span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">get_clams_age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">day_of_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_timedelta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clams_dat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.get_clams_age" title="Permalink to this definition"></a></dt>
<dd><p>Get the age of air predicted by the CLAMS model for points defined by potential temperature and equivalent latitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – a vector of potential temperatures, must be the same length as <code class="docutils literal notranslate"><span class="pre">eq_lat</span></code></p></li>
<li><p><strong>eq_lat</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – a vector of equivalent latitudes, must be the same length as <code class="docutils literal notranslate"><span class="pre">theta</span></code></p></li>
<li><p><strong>day_of_year</strong> (<em>int</em>) – which day of the year (e.g. Feb 1 = 32) to look up the age for</p></li>
<li><p><strong>as_timedelta</strong> (<em>bool</em>) – set this to <code class="docutils literal notranslate"><span class="pre">True</span></code> to return the ages as <code class="xref py py-class docutils literal notranslate"><span class="pre">relativedelta</span></code> instances. When <code class="docutils literal notranslate"><span class="pre">False</span></code>
(default) just returned in fractional years.</p></li>
<li><p><strong>clams_dat</strong> (<em>dict</em>) – a dictionary containing the CLAMS data with keys ‘eqlat’ (l-element vector), ‘theta’ (m-element
vector), ‘doy’ (n-element vector), and ‘age’ (l-by-m-by-n array). This can be passed manually if you want to use a
custom map of age of air vs. equivalent latitude and theta, but by default will be read in from the CLAMS file
provided by Arlyn Andrews and cached.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a vector of ages the same length as <code class="docutils literal notranslate"><span class="pre">theta</span></code> and <code class="docutils literal notranslate"><span class="pre">eq_lat</span></code>. The contents of the vector depend on the
value of <code class="docutils literal notranslate"><span class="pre">as_timedelta</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.get_trop_eq_lat">
<span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">get_trop_eq_lat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prof_theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_levels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_wt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_wt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtheta_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_theta_v_lat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.get_trop_eq_lat" title="Permalink to this definition"></a></dt>
<dd><p>Compute the tropospheric equivalent latitude for an observation based on its mid-tropospheric potential temperature</p>
<p>The rationale for using this approach is described in the module help for backend_analysis/geos_theta_lat.py. This
function relies on a climatology created by that module, which should contain the zonal mean relationship between
mid-tropospheric potential temperature and latitude at 2 week intervals.</p>
<p>This function finds the equivalent latitude for an observation by looking for the point in the same hemisphere that
has the closest mid-tropospheric potential temperature in the climatology as does the profile given as input.
Exactly what is defined as mid-troposphere is set by the pressure range in the climatology file, currently it is
700-500 hPa.</p>
<p>This function checks both north and south of the observation latitude for the climatology latitude with the closest
potential temperature. As long as one is sufficiently closer to the observation’s potential temperature, that one
is chosen directly. If the two are within the limit set by <code class="docutils literal notranslate"><span class="pre">dtheta_cutoff</span></code>, then a more careful check is
necessary. The limit is defined as:</p>
<div class="math notranslate nohighlight">
\[|(el_s - l) - (el_n - l)| &lt; d    heta\]</div>
<p>where <span class="math notranslate nohighlight">\(el_s\)</span> and <span class="math notranslate nohighlight">\(el_n\)</span> are the southern and northern latitudes in the climatology with the closest
potential temperature to the observations, <span class="math notranslate nohighlight">\(l\)</span> is the observation latitude, and <span class="math notranslate nohighlight">\(d      heta\)</span> is
<code class="docutils literal notranslate"><span class="pre">dtheta_cutoff</span></code>.  If this condition is met, then rather than just choosing whichever one has the closer
potential temperature, the algorithm uses a cost function:</p>
<p>where <span class="math notranslate nohighlight">\(w_t\)</span> and <span class="math notranslate nohighlight">\(w_l\)</span> are the weights for potential temperature (<code class="docutils literal notranslate"><span class="pre">theta_wt</span></code>) and latitude (<code class="docutils literal notranslate"><span class="pre">lat_wt</span></code>)
respectively, and <span class="math notranslate nohighlight">\(d  heta\)</span> and <span class="math notranslate nohighlight">\(dl\)</span> are the difference in potential temperature and latitude,
respectively, between the observation and the point chosen on the climatology curve.</p>
<p>The goal of this approach is to deal with two cases:</p>
<ol class="arabic simple">
<li><p>when the theta vs. lat curve from the climatology is monotonically increasing or decreasing</p></li>
<li><p>when the curve has a minimum or maximum</p></li>
</ol>
<p>For #1, consider a case where theta decreases with latitude, and the observation’s theta is greater than the
climatological theta for that latitude. Then going south will match the theta much better, so the cutoff condition
is not met, and we automatically choose the southern point.</p>
<p>For #2, consider again a case where the observation’s theta is greater that climatological theta for that latitude,
but now the climatological curve has a minimum just north of the observation. In that case, we may find two equally
good matches for the observation’s theta, so, in the absence of other information, we choose the nearer one. This is
admittedly a simplification - it is entirely possible that the actual synoptic transport carried air from the
further position, but without a second tracer to differentiate that in the meteorology data, or information on
prevailing north/south transport for a given lat/lon, the best assumption is to favor shorter transport.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prof_theta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – the profile of potential temperature values associated with this observation</p></li>
<li><p><strong>p_levels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – the profile of pressure levels that <code class="docutils literal notranslate"><span class="pre">prof_theta</span></code> is defined on</p></li>
<li><p><strong>obs_lat</strong> (<em>float</em>) – the geographic latitude of the observation</p></li>
<li><p><strong>obs_date</strong> (<em>datetime-lik</em>) – the date of the observation</p></li>
<li><p><strong>theta_wt</strong> (<em>float</em>) – a weight to use when deciding between two different latitudes with similar theta values. Increasing
this relative to <code class="docutils literal notranslate"><span class="pre">lat_wt</span></code> will increase the cost for choosing the point with a greater difference in potential
temperature.</p></li>
<li><p><strong>lat_wt</strong> (<em>float</em>) – similar to <code class="docutils literal notranslate"><span class="pre">theta_wt</span></code>, but increasing this prefers the point closer in latitude.</p></li>
<li><p><strong>dtheta_cutoff</strong> (<em>float</em>) – how close the two (north and south) differences between the climatology and observed
mid-troposphere potential temperature have to be to take into account which one is closer. See above.</p></li>
<li><p><strong>_theta_v_lat</strong> – not intended to pass in; this is a dictionary that will be given the values read in from the
climatology file to cache them for future function calls.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the equivalent latitude derived from mid-tropospheric potential temperature</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.modify_strat_co">
<span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">modify_strat_co</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_co_profile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pres_profile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eqlat_profile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt_profile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trop_pres</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prof_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_transition_pressures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(30.0,</span> <span class="pre">10.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excess_co_lut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/home/jlaugh/Python/envs/ginput-new/py-ginput-devel-git/ginput/data/meso_co_lut.nc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_orig_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.modify_strat_co" title="Permalink to this definition"></a></dt>
<dd><p>Takes the baseline GEOS CO profile and adds the mesospheric contribution to the stratosphere.</p>
<p>The GEOS FP-IT product includes CO profiles, however it does not account for CO drawn down from the mesosphere into
the stratosphere. This function adds an estimated contribution of mesospheric CO, derived from ACE-FTS data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_co_profile</strong> (<em>array-like</em>) – the baseline CO profile in ppb.</p></li>
<li><p><strong>pres_profile</strong> (<em>array-like</em>) – the pressure levels that the CO profile is defined on.</p></li>
<li><p><strong>eqlat_profile</strong> (<em>arrary-like</em>) – the equivalent latitude profile, in degrees north.</p></li>
<li><p><strong>pt_profile</strong> (<em>array-like</em>) – the potential temperature profile on the same levels as the CO profile, in Kelvin.</p></li>
<li><p><strong>trop_pres</strong> (<em>float</em>) – the tropopause pressure, in the same units as the pressure profile.</p></li>
<li><p><strong>prof_date</strong> (<em>datetime-like</em>) – the date of the profile</p></li>
<li><p><strong>excess_co_lut</strong> (<em>str</em>) – the path to the lookup table with the excess mesospheric CO. If not given, the standard table
file included in the repo is used. This file is created with
<code class="xref py py-func docutils literal notranslate"><span class="pre">ginput.priors.backend_analysis.ace_fts_analysis.make_excess_co_lut()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the CO profile with the CO from mesospheric descent added.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ginput.priors.tccon_priors.regenerate_gas_strat_lut_files">
<span class="sig-prename descclassname"><span class="pre">ginput.priors.tccon_priors.</span></span><span class="sig-name descname"><span class="pre">regenerate_gas_strat_lut_files</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ginput.priors.tccon_priors.regenerate_gas_strat_lut_files" title="Permalink to this definition"></a></dt>
<dd><p>Driver function to regenerate the stratospheric concentration lookup tables for all of the gas records.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../code_design/sat_interface.html" class="btn btn-neutral float-left" title="Satellite priors interface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mlo_smo_prep.html" class="btn btn-neutral float-right" title="mlo_smo_prep module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Joshua Laughner and Sebastien Roche.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>